"use strict";var e=require("@babel/runtime/helpers/extends"),t=require("@react-three/fiber"),r=require("react"),n=require("three-stdlib");function c(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var o=c(r);const s=o.forwardRef((({domElement:r,selector:c,onChange:s,onLock:i,onUnlock:a,enabled:u=!0,makeDefault:l,...d},f)=>{const{camera:h,...m}=d,v=t.useThree((e=>e.setEvents)),E=t.useThree((e=>e.gl)),k=t.useThree((e=>e.camera)),b=t.useThree((e=>e.invalidate)),p=t.useThree((e=>e.events)),L=t.useThree((e=>e.get)),g=t.useThree((e=>e.set)),T=h||k,j=r||p.connected||E.domElement,[y]=o.useState((()=>new n.PointerLockControls(T)));return o.useEffect((()=>{if(u){y.connect(j);const e=L().events.compute;return v({compute(e,t){const r=t.size.width/2,n=t.size.height/2;t.pointer.set(r/t.size.width*2-1,-n/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{y.disconnect(),v({compute:e})}}}),[u,y]),o.useEffect((()=>{const e=e=>{b(),s&&s(e)};y.addEventListener("change",e),i&&y.addEventListener("lock",i),a&&y.addEventListener("unlock",a);const t=()=>y.lock(),r=c?Array.from(document.querySelectorAll(c)):[document];return r.forEach((e=>e&&e.addEventListener("click",t))),()=>{y.removeEventListener("change",e),i&&y.addEventListener("lock",i),a&&y.addEventListener("unlock",a),r.forEach((e=>e?e.removeEventListener("click",t):void 0))}}),[s,i,a,c,y,b]),o.useEffect((()=>{if(l){const e=L().controls;return g({controls:y}),()=>g({controls:e})}}),[l,y]),o.createElement("primitive",e({ref:f,object:y},m))}));exports.PointerLockControls=s;
