"use strict";var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("three"),n=require("@react-three/fiber"),o=require("three-stdlib");function a(e){var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var i=a(r),s=a(t);function c(e=[0,0,0]){return function(e){return Array.isArray(e)}(e)?e:e instanceof s.Vector3||e instanceof s.Euler?[e.x,e.y,e.z]:[e,e,e]}const l=i.forwardRef((function({debug:r,depthTest:t=!1,polygonOffsetFactor:a=-10,map:l,mesh:u,children:p,position:f,rotation:m,scale:y,...d},h){const b=i.useRef(null);i.useImperativeHandle(h,(()=>b.current));const w=i.useRef(null);return i.useLayoutEffect((()=>{const e=(null==u?void 0:u.current)||b.current.parent,r=b.current;if(!(e instanceof s.Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const t={position:new s.Vector3,rotation:new s.Euler,scale:new s.Vector3(1,1,1)};if(e){n.applyProps(t,{position:f,scale:y});const a=e.matrixWorld.clone();if(e.matrixWorld.identity(),m&&"number"!=typeof m)n.applyProps(t,{rotation:m});else{const r=new s.Object3D;r.position.copy(t.position),r.lookAt(e.position),"number"==typeof m&&r.rotateZ(m),n.applyProps(t,{rotation:r.rotation})}return r.geometry=new o.DecalGeometry(e,t.position,t.rotation,t.scale),w.current&&(n.applyProps(w.current,t),w.current.traverse((e=>e.raycast=()=>null))),e.matrixWorld=a,()=>{r.geometry.dispose()}}}),[u,...c(f),...c(y),...c(m)]),i.createElement("mesh",e({ref:b,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":a,"material-depthTest":t,"material-map":l},d),p,r&&i.createElement("mesh",{ref:w},i.createElement("boxGeometry",null),i.createElement("meshNormalMaterial",{wireframe:!0}),i.createElement("axesHelper",null)))}));exports.Decal=l;
