"use strict";var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("@react-three/fiber"),u=require("react-merge-refs"),n=require("./useFBO.cjs.js");function a(e){var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var u=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,u.get?u:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("three");var c=a(r);const s=c.forwardRef((({envMap:r,resolution:a=256,frames:s=1/0,children:i,makeDefault:o,...l},f)=>{const g=t.useThree((({set:e})=>e)),h=t.useThree((({camera:e})=>e)),m=t.useThree((({size:e})=>e)),d=c.useRef(null),b=c.useRef(null),p=n.useFBO(a);c.useLayoutEffect((()=>{l.manual||d.current.updateProjectionMatrix()}),[m,l]),c.useLayoutEffect((()=>{d.current.updateProjectionMatrix()})),c.useLayoutEffect((()=>{if(o){const e=h;return g((()=>({camera:d.current}))),()=>g((()=>({camera:e})))}}),[d,o,g]);let j=0,O=null;const v="function"==typeof i;return t.useFrame((e=>{v&&(s===1/0||j<s)&&(b.current.visible=!1,e.gl.setRenderTarget(p),O=e.scene.background,r&&(e.scene.background=r),e.gl.render(e.scene,d.current),e.scene.background=O,e.gl.setRenderTarget(null),b.current.visible=!0,j++)})),c.createElement(c.Fragment,null,c.createElement("orthographicCamera",e({left:m.width/-2,right:m.width/2,top:m.height/2,bottom:m.height/-2,ref:u([d,f])},l),!v&&i),c.createElement("group",{ref:b},v&&i(p.texture)))}));exports.OrthographicCamera=s;
