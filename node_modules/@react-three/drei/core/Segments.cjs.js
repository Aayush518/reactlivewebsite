"use strict";var e=require("@babel/runtime/helpers/extends"),t=require("three"),r=require("react"),n=require("react-merge-refs"),o=require("@react-three/fiber"),c=require("three-stdlib");function s(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var i=s(t),a=s(r);const u=a.createContext(null),l=a.forwardRef(((t,r)=>{a.useMemo((()=>o.extend({SegmentObject:m})),[]);const{limit:n=1e3,lineWidth:s=1,children:l,...f}=t,[b,d]=a.useState([]),[g]=a.useState((()=>new c.Line2)),[h]=a.useState((()=>new c.LineMaterial)),[w]=a.useState((()=>new c.LineSegmentsGeometry)),[S]=a.useState((()=>new i.Vector2(512,512))),[p]=a.useState((()=>Array(6*n).fill(0))),[v]=a.useState((()=>Array(6*n).fill(0))),j=a.useMemo((()=>({subscribe:e=>(d((t=>[...t,e])),()=>d((t=>t.filter((t=>t.current!==e.current)))))})),[]);return o.useFrame((()=>{for(let t=0;t<n;t++){var e;const r=null==(e=b[t])?void 0:e.current;r&&(p[6*t+0]=r.start.x,p[6*t+1]=r.start.y,p[6*t+2]=r.start.z,p[6*t+3]=r.end.x,p[6*t+4]=r.end.y,p[6*t+5]=r.end.z,v[6*t+0]=r.color.r,v[6*t+1]=r.color.g,v[6*t+2]=r.color.b,v[6*t+3]=r.color.r,v[6*t+4]=r.color.g,v[6*t+5]=r.color.b)}w.setColors(v),w.setPositions(p),g.computeLineDistances()})),a.createElement("primitive",{object:g,ref:r},a.createElement("primitive",{object:w,attach:"geometry"}),a.createElement("primitive",e({object:h,attach:"material",vertexColors:!0,resolution:S,linewidth:s},f)),a.createElement(u.Provider,{value:j},l))}));class m{constructor(){this.color=new i.Color("white"),this.start=new i.Vector3(0,0,0),this.end=new i.Vector3(0,0,0)}}const f=e=>e instanceof i.Vector3?e:new i.Vector3(..."number"==typeof e?[e,e,e]:e),b=a.forwardRef((({color:e,start:t,end:r},o)=>{const c=a.useContext(u);if(!c)throw"Segment must used inside Segments component.";const s=a.useRef(null);return a.useLayoutEffect((()=>c.subscribe(s)),[]),a.createElement("segmentObject",{ref:n([s,o]),color:e,start:f(t),end:f(r)})}));exports.Segment=b,exports.SegmentObject=m,exports.Segments=l;
