"use strict";var e=require("react"),t=require("zustand"),r=require("zustand/middleware");function n(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var s=n(e);const o=t.default||t,u=s.createContext(null);exports.KeyboardControls=function({map:e,children:t,onChange:n,domElement:c}){const a=e.map((e=>e.name+e.keys)).join("-"),d=s.useMemo((()=>o(r.subscribeWithSelector((()=>e.reduce(((e,t)=>({...e,[t.name]:!1})),{}))))),[a]),i=s.useMemo((()=>[d.subscribe,d.getState,d]),[a]),f=d.setState;return s.useEffect((()=>{const t=e.map((({name:e,keys:t,up:r})=>({keys:t,up:r,fn:t=>{f({[e]:t}),n&&n(e,t,i[1]())}}))).reduce(((e,{keys:t,fn:r,up:n=!0})=>(t.forEach((t=>e[t]={fn:r,pressed:!1,up:n})),e)),{}),r=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:s,pressed:o,up:u}=n;n.pressed=!0,!u&&o||s(!0)},s=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:s,up:o}=n;n.pressed=!1,o&&s(!1)},o=c||window;return o.addEventListener("keydown",r,{passive:!0}),o.addEventListener("keyup",s,{passive:!0}),()=>{o.removeEventListener("keydown",r),o.removeEventListener("keyup",s)}}),[c,a]),s.createElement(u.Provider,{value:i,children:t})},exports.useKeyboardControls=function(e){const[t,r,n]=s.useContext(u);return e?n(e):[t,r]};
