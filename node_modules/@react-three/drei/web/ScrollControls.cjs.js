"use strict";var e=require("@babel/runtime/helpers/extends"),t=require("react"),r=require("react-dom/client"),o=require("@react-three/fiber"),n=require("react-merge-refs"),s=require("maath");function l(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var i=l(t),c=l(r);const a=i.createContext(null);function f(){return i.useContext(a)}const u=i.forwardRef((({children:e},t)=>{const r=i.useRef(null),s=f(),{width:l,height:c}=o.useThree((e=>e.viewport));return o.useFrame((()=>{r.current.position.x=s.horizontal?-l*(s.pages-1)*s.offset:0,r.current.position.y=s.horizontal?0:c*(s.pages-1)*s.offset})),i.createElement("group",{ref:n([t,r])},e)})),d=i.forwardRef((({children:t,style:r,...s},l)=>{const u=f(),d=i.useRef(null),{width:h,height:p}=o.useThree((e=>e.size)),m=i.useContext(o.context),v=i.useMemo((()=>c.createRoot(u.fixed)),[u.fixed]);return o.useFrame((()=>{u.delta>u.eps&&(d.current.style.transform=`translate3d(${u.horizontal?-h*(u.pages-1)*u.offset:0}px,${u.horizontal?0:p*(u.pages-1)*-u.offset}px,0)`)})),v.render(i.createElement("div",e({ref:n([l,d]),style:{...r,position:"absolute",top:0,left:0,willChange:"transform"}},s),i.createElement(a.Provider,{value:u},i.createElement(o.context.Provider,{value:m},t)))),null})),h=i.forwardRef((({html:t,...r},o)=>{const n=t?d:u;return i.createElement(n,e({ref:o},r))}));exports.Scroll=h,exports.ScrollControls=function({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:n,pages:l=1,distance:c=1,damping:f=.25,maxSpeed:u=1/0,style:d={},children:h}){const{get:p,setEvents:m,gl:v,size:g,invalidate:y,events:w}=o.useThree(),[x]=i.useState((()=>document.createElement("div"))),[E]=i.useState((()=>document.createElement("div"))),[b]=i.useState((()=>document.createElement("div"))),z=v.domElement.parentNode,C=i.useRef(0),L=i.useMemo((()=>{const t={el:x,eps:e,fill:E,fixed:b,horizontal:n,damping:f,offset:0,delta:0,scroll:C,pages:l,range(e,t,r=0){const o=e-r,n=o+t+2*r;return this.offset<o?0:this.offset>n?1:(this.offset-o)/(n-o)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){const o=e-r,n=o+t+2*r;return this.offset>=o&&this.offset<=n}};return t}),[e,f,n,l]);i.useEffect((()=>{x.style.position="absolute",x.style.width="100%",x.style.height="100%",x.style[n?"overflowX":"overflowY"]="auto",x.style[n?"overflowY":"overflowX"]="hidden",x.style.top="0px",x.style.left="0px";for(const e in d)x.style[e]=d[e];b.style.position="sticky",b.style.top="0px",b.style.left="0px",b.style.width="100%",b.style.height="100%",b.style.overflow="hidden",x.appendChild(b),E.style.height=n?"100%":l*c*100+"%",E.style.width=n?l*c*100+"%":"100%",E.style.pointerEvents="none",x.appendChild(E),z.appendChild(x),x[n?"scrollLeft":"scrollTop"]=1;const e=w.connected||v.domElement;requestAnimationFrame((()=>null==w.connect?void 0:w.connect(x)));const t=p().events.compute;return m({compute(e,t){const{left:r,top:o}=z.getBoundingClientRect(),n=e.clientX-r,s=e.clientY-o;t.pointer.set(n/t.size.width*2-1,-s/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{z.removeChild(x),m({compute:t}),null==w.connect||w.connect(e)}}),[l,c,n,x,E,b,z]),i.useEffect((()=>{if(w.connected===x){const e=g[n?"width":"height"],o=x[n?"scrollWidth":"scrollHeight"],s=o-e;let l=0,i=!0,c=!0;const a=()=>{if(t&&!c&&(y(),l=x[n?"scrollLeft":"scrollTop"],C.current=l/s,r)){if(!i)if(l>=s){const e=1-L.offset;x[n?"scrollLeft":"scrollTop"]=1,C.current=L.offset=-e,i=!0}else if(l<=0){const e=1+L.offset;x[n?"scrollLeft":"scrollTop"]=o,C.current=L.offset=e,i=!0}i&&setTimeout((()=>i=!1),40)}};x.addEventListener("scroll",a,{passive:!0}),requestAnimationFrame((()=>c=!1));const f=e=>x.scrollLeft+=e.deltaY/2;return n&&x.addEventListener("wheel",f,{passive:!0}),()=>{x.removeEventListener("scroll",a),n&&x.removeEventListener("wheel",f)}}}),[x,w,g,r,L,y,n,t]);let q=0;return o.useFrame(((t,r)=>{q=L.offset,s.easing.damp(L,"offset",C.current,f,r,u,void 0,e),s.easing.damp(L,"delta",Math.abs(q-L.offset),f,r,u,void 0,e),L.delta>e&&y()})),i.createElement(a.Provider,{value:L},h)},exports.useScroll=f;
